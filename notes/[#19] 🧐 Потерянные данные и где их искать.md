üßê **–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –≥–¥–µ –∏—Ö –∏—Å–∫–∞—Ç—å**
.
–†–∞–±–æ—á–∏–π –∫–µ–π—Å –Ω–∞—á–∞–ª—Å—è —Ç–∞–∫:

```
–ü—Ä–æ–ø–∞–ª–∞ –Ω–µ–¥–µ–ª—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ <table>
...
–¥–∞–Ω–Ω—ã–µ —Ç–æ—á–Ω–æ –±—ã–ª–∏ –º–µ–Ω—å—à–µ –Ω–µ–¥–µ–ª–∏ –Ω–∞–∑–∞–¥ —Ç.–∫ –µ—Å—Ç—å –≤ –Ω–∞—à–∏—Ö –∞–≥—Ä–µ–≥–∞—Ç–∞—Ö.
```

–î–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: <table> - —ç—Ç–æ –∑–æ–ª–æ—Ç–æ, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–∞–∂–µ –ø—ã–ª–∏–Ω–∫–∏ –Ω—É–∂–Ω–æ —Å–¥—É–≤–∞—Ç—å –æ—á–µ–Ω—å –∞–∫–∫—É—Ä–∞—Ç–Ω–æ, –≤ –æ–±—â–µ–º, –û–ß–ï–ù–¨ –í–ê–ñ–ù–´–ï –¥–∞–Ω–Ω—ã–µ.

–ü–∞–º—è—Ç—å –ø–æ–¥–∫–∏–¥—ã–≤–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã –≥–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å/—á—Ç–æ –¥–µ–ª–∞—Ç—å:
- –º–æ–∂–µ—Ç –∫—Ç–æ-—Ç–æ –¥—Ä–æ–ø–Ω—É–ª –ø–∞—Ä—Ç–∏—Ü–∏–∏
- –º–æ–∂–µ—Ç –∫—Ç–æ-—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª DELETE (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–∏—Ç)
- –º–æ–∂–µ—Ç –º—ã –¥–µ–ª–∞–ª–∏ –±–µ–∫—Ñ–∏–ª–ª —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –∞ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã (–ø–æ—á—Ç–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ)
- —Å–¥–µ–ª–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ —Å—ã—Ä—å—è –Ω–∞ s3 (–µ—Å–ª–∏ —Ç–∞–º –µ—Å—Ç—å ü§û, —Ç–æ —Ç–æ—á–Ω–Ω–æ –ø—Ä–æ–±–ª–µ–º—ã —É–∂–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ Clickhouse)
- ...

‚òùÔ∏è–ö–ª—é—á–µ–≤–æ–µ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ: –≤–µ—Ä–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø–æ—Å–ª–µ —Ä–∞–∑–±–∏—Ä–∞–µ–º—Å—è —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏. –ü–æ—ç—Ç–æ–º—É –ø–µ—Ä–≤—ã–º –≤—ã–ø–æ–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—É–Ω–∫—Ç:
- –ø—Ä–æ–≤–µ—Ä–∫–∞, —Ñ—É—Ö, –¥–∞–Ω–Ω—ã–µ –Ω–∞ –º–µ—Å—Ç–µ ‚úÖ
- –Ω–∞—á–∏–Ω–∞–µ–º —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ üßê

–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—à–µ–∏–∑–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –∏ –¥—Ä—É–≥–∏—Ö (–µ—â–µ –±–æ–ª–µ–µ –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö) –Ω–µ –ø—Ä–∏–≤–µ–ª–∞ –∫ —É—Å–ø–µ—Ö—É üò≠, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞:
- –ª–æ–≥ –∑–∞–ø—Ä–æ—Å–æ–≤ `system.query_log`
- —Ç–∞–±–ª–∏—Ü–∞ —Å –ø–∞—Ä—Ç–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö `system.parts`
- –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–º–∏—Ö –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ—Ö—É–¥—à–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
- –ø—Ä–∏—á–∏–Ω—ã –Ω–µ –∑–Ω–∞–µ–º (–¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–∏—á–∏–Ω–æ–π –Ω–∏—á–µ–≥–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ —Å–º–æ–∂–µ–º, —Ç–æ —Ö–æ—Ç—è –±—ã —Ä–∞–Ω–Ω–µ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥) –Ω–∞–º –ø–æ–º–æ–∂–µ—Ç)
- –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–∂–µ–º

–•–æ—Ç–µ–ª–æ—Å—å –±—ã –Ω–∞–ø–∏—Å–∞—Ç—å, —á—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏—à–ª–æ –∫–∞–∫ –æ–∑–∞—Ä–µ–Ω–∏–µ, –Ω–æ –≤–µ—Ä—é, —á—Ç–æ —ç—Ç–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –æ–ø—ã—Ç –∏ –Ω–∞—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∫—É–ø–µ —Å –±–µ–∑—ã–∏—Å—Ö–æ–¥–Ω–æ—Å—Ç—å—é üôÉ,
–≤ –æ—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—é –ø–æ –∫—Ä—É–≥—É –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∏–¥–µ–∏ –∏ —Å–µ–ª–µ–∫–∞—è —Ç–∞–±–ª–∏—Ü—ã query_log –∏ parts, –≤–≥–ª—è–¥ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –Ω–∞ –∞—Ç—Ä–∏–±—É—Ç–µ active –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ø–∞—Ä—Ç–æ–≤:

```
active (UInt8) ‚Äì –§–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–∞, –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ. 
–í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω–∞ —É–¥–∞–ª—è–µ—Ç—Å—è. –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è.
```

–ù–∏ –æ–Ω –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ —Ä–µ—à–µ–Ω–∏–∏, –∞ –º—ã—Å–ª–∏ —Ä–æ–∂–¥–µ–Ω–Ω—ã–µ –∏–º: –Ω–∞—á–∞–ª –∏—Å–∫–∞—Ç—å –≥–¥–µ –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –∏–Ω—Ñ–∞ –ø–æ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º –ø–∞—Ä—Ç–∞–º –¥–∞–Ω–Ω—ã—Ö
(–ø—Ä–æ–∏–∑–æ–π—Ç–∏ —Å –Ω–∏–º–∏ –º–æ–∂–µ—Ç –≤—Å—ë —á—Ç–æ —É–≥–æ–¥–Ω–æ (—ç—Ç–æ –∂–µ Clickhouse) + –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç–∏ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è).

–ü–æ–∏—Å–∫–∏ –ø—Ä–∏–≤–µ–ª–∏ –≤ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `system.detached_parts`:

```
Contains information about detached parts of MergeTree tables. The reason column specifies why the part was detached.

For user-detached parts, the reason is empty. Such parts can be attached with ALTER TABLE ATTACH PARTITION|PART command.
```

–°–∞–º–∞—è –≤–∞–∂–Ω–æ–µ —Å–ª–µ–¥—É—é—â–µ–µ: **For user-detached parts, the reason is empty**, –∏–±–æ —Ç–æ–ª—å–∫–æ –∏—Ö –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –æ–±—Ä–∞—Ç–Ω–æ.

–ü–æ–≥—Ä—É–∂–∞–µ–º—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `system.detached_parts`, –Ω–∞—Ö–æ–¥–∏–º –¥–µ—Ç–∞—á–Ω—É—Ç—ã–µ –ø–∞—Ä—Ç—ã –¥–ª—è –û–ß–ï–ù–¨ –≤–∞–∂–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã 
–∏ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ä–æ–≤–Ω–æ –≤ –ø–∞—Ä—Ç–∏—Ü–∏—è—Ö –ø—Ä–æ–ø–∞–≤—à–µ–π –Ω–µ–¥–µ–ª–∏ üéâ –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–ª—å—à–µ –ø–æ `reason = '' (empty reason)` –∏ —Ç–∞–∫–∏–µ —Ç–æ–∂–µ –µ—Å—Ç—å –∏ –≤ —Ç–µ—Ö –∂–µ –¥–∞—Ç–∞—Ö.
–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∏–Ω–∂–µ–Ω–µ—Ä –ª–∏–∫—É–µ—Ç, –æ—Å—Ç–∞–µ—Ç—Å—è –∞—Ç—Ç–∞—á–Ω—É—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—É... –∏ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è `–∫—Ç–æ –≤–∏–Ω–æ–≤–Ω–∏–∫ –¥–µ—Ç–∞—á–∞` –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- üî© –∞—Ç—Ç–∞—á, –∞—Ç—Ç–∞—á, –∞—Ç—Ç–∞—á .... –Ω–µ –≤—Å–µ –ø–∞—Ä—Ç—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –æ–±—Ä–∞—Ç–Ω–æ, –Ω–æ ~95% –≤–µ—Ä–Ω—É–ª–∞—Å—å, –ø—Ä–∏—á–∏–Ω—ã –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã,
—Ç–∫ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —Ä–æ—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å (–ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–æ–ø–∞–≤—à–µ–π –Ω–µ–¥–µ–ª–µ–π –≤—ã—è–≤–∏–ª–∞—Å—å —Å–ø—É—Å—Ç—è –ø–æ–ª—Ç–æ—Ä–∞-2 –º–µ—Å—è—Ü–∞ ü§∑)
- üë®‚Äçüíª —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è `–∫—Ç–æ –≤–∏–Ω–æ–≤–Ω–∏–∫ –¥–µ—Ç–∞—á–∞`: —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ query_log + —Ç–∏–∫–µ—Ç –≤ –¢–ü –Ø–Ω–¥–µ–∫—Å–û–±–ª–∞–∫–∞. –ü–æ–∏—Å–∫ –ø–æ query_log —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–µ –¥–∞–ª, 
–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ø–û –±–µ–∑ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤ —Å–∫–∞–∑–∞—Ç—å –Ω–∏—á–µ–≥–æ –Ω–µ —Å–º–æ–≥–ª–∞. 
- üëÄ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ—Ç–∞—á–Ω—É—Ö –ø–∞—Ä—Ç–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–ª–∏ -> –¥–∞—à–±–æ—Ä–¥ –≤ Datalens 


**–≠–ø–∏–ª–æ–≥:**
–¢–∫ —Ç–∞–±–ª–∏—Ü–∞ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –≤–∞–∂–Ω–∞—è, –∫—Ç–æ-—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ä—É—á–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–µ—Ç–∞—á –ø–∞—Ä—Ç–æ–≤ —Å–¥–µ–ª–∞—Ç—å –Ω–µ –º–æ–≥ (—ç—Ç–æ —Å—Ä–æ–¥–Ω–∏ –¥—Ä–æ–ø—É/—Ç—Ä–∞–Ω–∫–µ–π—Ç—É –ø—Ä–æ–¥–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –¥–∞ —Ç–∞–∫–æ–µ –º–æ–∂–µ—Ç —Å–ª—É—á–∞—Ç—å—Å—è, –Ω–æ —Å–ª–∏—à–∫–æ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞).
–ü–æ–∫–∞ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—é—Å—å –∏–¥–µ–∏, —á—Ç–æ –º–æ–≥–ª–æ –∑–∞—Ü–µ–ø–∏—Ç—å –ø—Ä–∏ –∫–∞–∫–∏—Ö-–ª–∏–±–æ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –¢–ü, –Ω–æ —Ç–∞–º –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç–æ–≥–¥–∞ –Ω–∏—á–µ–≥–æ –∏ –Ω–∏–∫—Ç–æ –Ω–µ —É–∑–Ω–∞–µ—Ç.

–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ üëª

tags:
- #clickhouse
- #detached_parts

